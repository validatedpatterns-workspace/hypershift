# Default values for hypershift.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

# Cluster Autoscaling Configuration
#
# Enable and configure cluster autoscaling for dynamic node management
autoscaling:
  # ClusterAutoscaler - cluster-wide autoscaler settings
  clusterAutoscaler:
    enabled: false
    # Balance similar node groups (e.g., MachineSets across AZs) to spread nodes evenly
    balanceSimilarNodeGroups: true
    # Allow scale-down of nodes with pods using local storage (emptyDir)
    # Set to true to prevent scaling down nodes with local storage pods
    skipNodesWithLocalStorage: false
    # Pods with priority lower than this will not prevent node scale down
    podPriorityThreshold: -10
    resourceLimits:
      # Maximum number of nodes in the cluster (including control plane)
      maxNodesTotal: 24
      # Optional: CPU cores limits across all nodes
      cores:
        min: 8
        max: 128
      # Optional: Memory limits across all nodes (in GB)
      memory:
        min: 32
        max: 512
    scaleDown:
      enabled: true
      # How long after scale up before scale down evaluation
      delayAfterAdd: "10m"
      # How long after node deletion before another deletion
      delayAfterDelete: "5m"
      # How long after scale down failure before retry
      delayAfterFailure: "30s"
      # How long a node should be unneeded before scale down
      unneededTime: "5m"
      # Node utilization threshold below which scale down is considered
      utilizationThreshold: "0.4"

  # MachineAutoscalers - per-MachineSet autoscaling configuration
  # Define one entry per MachineSet you want to autoscale
  machineAutoscalers: []
  # Example configuration:
  # - name: worker-us-east-1a
  #   enabled: true
  #   machineSetName: cluster-name-worker-us-east-1a
  #   minReplicas: 1
  #   maxReplicas: 6
  # - name: worker-us-east-1b
  #   enabled: true
  #   machineSetName: cluster-name-worker-us-east-1b
  #   minReplicas: 1
  #   maxReplicas: 6

# Role Based Access Controls
#
# Provide a list of users to add to the clusterrolebinding
rbac:
  create: true
  role:
    name: hcp-admins-crole
  roleBinding:
    name: hcp-admins-crb
  users: []

clusterGroup:
  isHubCluster: true

# Reference the Hashicorp Vault backend for ESO
secretStore:
  name: vault-backend
  kind: ClusterSecretStore

# Secret provisioned for the HyperShift installation 
awsCredentials:
  key: secret/data/hub/awsCreds

# Begin global parameters
global:
  hubClusterDomain: hub.example.com
  localClusterDomain: region-one.example.com

# Provision External Secret resources: default true
  useExternalSecrets: true

# S3 bucket information
  hypershift:
    oidc:
      region: ''
      bucketName: ''

# End global parameters

# MultiCluster Engine Components
mce:
  targetNS: multicluster-engine
  availabilityConfig: High
  components:
    - name: image-based-install-operator
      enabled: "false"
    - name: assisted-service
    - name: cluster-lifecycle
    - name: cluster-manager
    - name: discovery
    - name: hive
    - name: server-foundation
    - name: cluster-proxy-addon
    - name: local-cluster
    - name: hypershift-local-hosting
    - name: managedserviceaccount
    - name: hypershift
    - name: console-mce
    - name: cluster-api
      enabled: "false"
    - name: cluster-api-provider-aws
      enabled: "false"
    - name: cluster-api-provider-metal3
      enabled: "false"
    - name: cluster-api-provider-openshift-assisted
      enabled: "false"
